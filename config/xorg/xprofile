#!/usr/bin/env sh
#
# A collection of commands to run on the start of an X session.
# This should be sourced by ~/.xinitrc or your display manager, and not simply
# loaded alone.

gen-xres | xrdb # update xresources database

# wm-specific config
case "$WM" in
  dwm)
    dwmblocks &
    ;;
  penrose)
    start-polybar &
    ;;
esac

if [ "$WM" = bspwm ]; then
  start-sxhkd standard bspwm
else
  start-sxhkd standard
fi &

# background applications
picom -b --experimental-backend & # compositor
[ "$WM" != awesome ] && dunst -config "$XDG_CACHE_HOME/gen/dunstrc" & # notification daemon
flameshot & # screenshot app
nm-applet & # network manager on tray
monitor-battery &
blueman-applet &
setbg &

# extra config (async)
systemd-inhibit --what=handle-power-key sleep infinity & # disable power button
upkey & # keyboard config, put here because it kept deconfiguring every time I plugged a keyboard

# TODO: find an even better way to make this portable
xinput set-prop "Synaptics TM3096-006" "libinput Tapping Enabled" 1 # Touchpad: tap to click (not working)
xinput set-prop "Synaptics TM3096-006" "libinput Natural Scrolling Enabled" 1 # Touchpad: natural scrolling
