#!/usr/bin/env sh

# A collection of commands to run on the start of an X session.
# This should be sourced by ~/.xinitrc or your display manager, and not simply
# loaded alone.

# load environment variables (necessary to detect $WM)
. ~/.local/share/env.sh

# wm-specific config
case "$WM" in
  bspwm)
    # sxhkd is started in bspwmrc
    # setbg is started in bspwmrc
    ;;
  dwm)
    start-sxhkd standard &
    setbg &
    dwmblocks &
    ;;
  i3)
    start-sxhkd standard &
    setbg &
    ;;
esac

# background applications
picom -b & # compositor
dunst & # notification daemon
flameshot & # screenshot app
nm-applet & # network manager on tray
battery-check & # battery check (TODO: make a lighter and more stable script)
blueman-applet &

# extra config (async)
systemd-inhibit --what=handle-power-key sleep infinity & # disable power button

# extra config (not async)
setxkbmap -layout br # set keyboard layout
xset r rate 400 35 # speed up xrate
xrdb "${XDG_CONFIG_HOME}/xorg/xresources" # update X resources database

# TODO: find an even better way to make this portable
xinput set-prop "Synaptics TM3096-006" "libinput Tapping Enabled" 1 # Touchpad: tap to click (not working)
xinput set-prop "Synaptics TM3096-006" "libinput Natural Scrolling Enabled" 1 # Touchpad: natural scrolling
