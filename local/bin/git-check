#!/usr/bin/env bash

case $# in
    0) repo_dir="${PWD}" ;;
    1) repo_dir="${1}" ;;
    *) echo "$0: invalid amount of args." ;;
esac

if (cd "${repo_dir}" && git status -sb); then
    echo -e '\033[2 q'
    while [ -z "${EXIT}" ]; do
        echo -e "\e[33mCommands:\e[m [d]iff, [a]dd-commit, [p]ull, pu[s]h, [f]etch, [l]og, []exit"
        echo -n "       :: "
        read input
        case "${input}" in
            d)
                git add .
                git diff HEAD
                ;;
            a)
                git add . &&
                    git commit ||
                    git reset .
                ;;
            l) git log --all --oneline ;;
            p) git pull ;;
            s) git push ;;
            f) git fetch ;;
            "") EXIT=1 ;;
            "") clear ;;
            *) echo "Invalid command." ;;
        esac
    done
    exit "${EXIT}"
else
    exit 1
fi

# TODO: temp-cd to the git repo's root directory to perform the add.
# TODO: find a way to choose which files to add.
