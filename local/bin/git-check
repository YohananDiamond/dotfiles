#!/usr/bin/env bash

if [ $# != 1 ]; then
  echo "Usage: $(basename $0) <repo-path>"
  exit 1
fi

cd "$1" || exit

if git status -sb; then
  echo -e '\e[2 q'
  while [ -z "$EXIT" ]; do
    echo -e '\e[33mCommands:\e[m [d]iff, [a]dd-commit, [p]ull, pu[s]h, [f]etch, [l]og, [q]uit'
    printf " (git) Î»> "
    read -n1 ch; echo
    case "$ch" in
      d)
        git add .
        git diff HEAD
        ;;
      a) git add . && git commit || git reset . ;;
      l) git log --all --oneline ;;
      p) git pull ;;
      s) git push ;;
      f) git fetch ;;
      "") EXIT=0 ;;
      q) EXIT=0 ;;
      ) EXIT=0 ;;
      "") clear ;;
      *) echo "Invalid option: \"${ch}\"." ;;
    esac
  done
  exit "$EXIT"
else
  exit 1
fi

# TODO: temp-cd to the git repo's root directory to perform the add.
# TODO: find a way to choose which files to add.
