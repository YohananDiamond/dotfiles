#!/usr/bin/env sh

show_help() {
    echo "<Help not implemented yet>"
    exit 1
}

case $# in
    0)
        repo_dir="${PWD}"
        ;;
    1)
        repo_dir="${1}"
        ;;
    *)
        echo "$0: invalid amount of args."
        show_help
        ;;
esac

if (cd "${repo_dir}" && git status -sb); then
    echo "What do you want to do?"
    while [ -z "${EXIT}" ]; do
        echo "Commands: [d]iff, [a]dd-commit, [p]ull, pu[s]h, [f]etch, []exit"
        echo -n "=> "
        read input
        case "${input}" in
            d)
                git add .
                git diff HEAD
                ;;
            a)
                git add . &&
                    git commit ||
                    git reset .
                ;;
            p) git pull ;;
            s) git push ;;
            f) git fetch ;;
            "") EXIT=1 ;;
            "") clear ;;
            *) echo "Invalid command." ;;
        esac
    done
    exit "${EXIT}"
else
    exit 1
fi
