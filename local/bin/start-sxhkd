#!/usr/bin/env sh

# A script to load sxhkd based off the gen-sxhkd script.

source ~/.local/lib/ystd.sh
depCheck gen-sxhkd sxhkd mktemp

tempConf="$(mktemp "/tmp/sxhkd.conf.XXXXXXXX")"
tempLog="$(mktemp "/tmp/sxhkd.log.XXXXXXXX")"

if [ -z "$tempConf" ] || [ -z "$tempLog" ]; then
  printf >&2 "Could not generate all temp files."
  exit 1
fi

gen-sxhkd "$@" > "$tempConf"

if [ $? != 0 ]; then
  printf >&2 "gen-sxhkd failed; aborting\n"
  exit 1
fi

sxhkd -c "$tempConf" -r "$tempLog"
rm "$tempConf" # Remove the config after execution, but leave the log
